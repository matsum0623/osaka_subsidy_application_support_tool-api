const { core } = require('./core')

module.exports = {
  get_item: async (user_id) => {
    const response = await core.query('PK = :p_key AND SK = :s_key', {
      ':p_key': '#METADATA#USER',
      ':s_key': 'USER#' + user_id,
    })
    return (response.Items && response.Items.length > 0) ? response.Items[0] : {}
  },
  get_all: async () => {
    const response = await core.query('PK = :p_key AND begins_with(SK, :s_key)', {
      ':p_key': '#METADATA#USER',
      ':s_key': 'USER#',
    })
    return response.Items
  },
  put: async (user_id, user_name, email, after_schools, admin_flag) => {
    return await core.put({
      PK: '#METADATA#USER',
      SK: 'USER#' +  user_id,
      UserName: user_name,
      Email: email,
      AfterSchools: after_schools,
      Admin: admin_flag,
    })
  },
  delete: async (user_id) => {
    return await core.delete({
      PK: '#METADATA#USER',
      SK: 'USER#' + user_id,
    })
  }
}
